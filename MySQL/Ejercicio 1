CREATE TABLE CENTRO (
    codcentro   NUMBER(14) PRIMARY KEY,
    Nombre      VARCHAR2(100) UNIQUE NOT NULL,
    Localidad   VARCHAR2(100)
);

CREATE TABLE DOCENTE (
    coddocente  NUMBER(14) PRIMARY KEY,
    DNI         VARCHAR2(20) UNIQUE NOT NULL,
    Nombre      VARCHAR2(50) NOT NULL,
    Ap1         VARCHAR2(50) NOT NULL,
    Ap2         VARCHAR2(50),
    Email       VARCHAR2(100), 
    Telefono    VARCHAR2(20)   
);

CREATE TABLE CURSO_ACADEMICO (
    codcursoacademico NUMBER(14) PRIMARY KEY,
    Anio_Inicio       NUMBER(14)(4) NOT NULL,
    Anio_Fin          NUMBER(14)(4) NOT NULL,
    Periodo_Academico VARCHAR2(50)
);

CREATE TABLE ESTUDIANTE (
    codestudiante NUMBER(14) PRIMARY KEY,
    DNI           VARCHAR2(20) UNIQUE NOT NULL,
    Nombre        VARCHAR2(50) NOT NULL,
    Ap1           VARCHAR2(50) NOT NULL,
    Ap2           VARCHAR2(50),
    Telefono      VARCHAR2(20) 
);


CREATE TABLE CICLO_FORMATIVO (
    codcicloformativo NUMBER(14) PRIMARY KEY,
    Nombre            VARCHAR2(100) NOT NULL,
    Familia_Profesional VARCHAR2(100),
    codcentro         NUMBER(14),
    CONSTRAINT fk_ciclo_centro FOREIGN KEY (codcentro) 
        REFERENCES CENTRO(codcentro)
);

CREATE TABLE MODULO (
    codmodulo           NUMBER(14) PRIMARY KEY,
    Nombre              VARCHAR2(100) NOT NULL,
    Curso               VARCHAR2(50),
    Horas               NUMBER(14),
    codciclo_formativo  NUMBER(14),
    CONSTRAINT chk_horas_positivo CHECK (Horas > 0),
    CONSTRAINT fk_modulo_ciclo FOREIGN KEY (codciclo_formativo) 
        REFERENCES CICLO_FORMATIVO(codcicloformativo)
);

CREATE TABLE MATRICULA (
    codmatricula  NUMBER(14) PRIMARY KEY,
    codestudiante NUMBER(14),
    codmodulo     NUMBER(14),
    Nota          NUMBER(14)(4,2),
    Estado        VARCHAR2(20),
    CONSTRAINT fk_matri_estud FOREIGN KEY (codestudiante) 
        REFERENCES ESTUDIANTE(codestudiante),
    CONSTRAINT fk_matri_modulo FOREIGN KEY (codmodulo) 
        REFERENCES MODULO(codmodulo)
);

DROP TABLE CENTRO CASCADE CONSTRAINTS PURGE;
DROP TABLE CICLO_FORMATIVO CASCADE CONSTRAINTS PURGE;
DROP TABLE CURSO_ACADEMICO CASCADE CONSTRAINTS PURGE;
DROP TABLE DOCENTE CASCADE CONSTRAINTS PURGE;
DROP TABLE ESTUDIANTE CASCADE CONSTRAINTS PURGE;
DROP TABLE MODULO CASCADE CONSTRAINTS PURGE;
DROP TABLE MATRICULA CASCADE CONSTRAINTS PURGE;
